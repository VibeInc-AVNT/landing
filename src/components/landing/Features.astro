---
import { getLangFromUrl, useTranslations } from "@i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const { class: className } = Astro.props;

const availableFeatures = [
	{
		title: t("feature.semantic.title"),
		content: t("feature.semantic.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>`,
		color: "text-vibe-yellow",
		bgColor: "bg-vibe-yellow/10 dark:bg-vibe-yellow/20",
	},
	{
		title: t("feature.failover.title"),
		content: t("feature.failover.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"/></svg>`,
		color: "text-vibe-indigo",
		bgColor: "bg-vibe-indigo/10 dark:bg-vibe-indigo/20",
	},
	{
		title: t("feature.providers.title"),
		content: t("feature.providers.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
		color: "text-vibe-purple",
		bgColor: "bg-vibe-purple/10 dark:bg-vibe-purple/20",
	},
	{
		title: t("feature.streaming.title"),
		content: t("feature.streaming.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>`,
		color: "text-vibe-orange",
		bgColor: "bg-vibe-orange/10 dark:bg-vibe-orange/20",
	},
	{
		title: t("feature.ratelimit.title"),
		content: t("feature.ratelimit.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
		color: "text-vibe-red",
		bgColor: "bg-vibe-red/10 dark:bg-vibe-red/20",
	},
];

const rollingFeatures = [
	{
		title: t("feature.agnostic.title"),
		content: t("feature.agnostic.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>`,
		color: "text-vibe-yellow",
		bgColor: "bg-vibe-yellow/10 dark:bg-vibe-yellow/20",
	},
	{
		title: t("feature.edge.title"),
		content: t("feature.edge.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
		color: "text-vibe-indigo",
		bgColor: "bg-vibe-indigo/10 dark:bg-vibe-indigo/20",
	},
	{
		title: t("feature.config.title"),
		content: t("feature.config.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>`,
		color: "text-vibe-purple",
		bgColor: "bg-vibe-purple/10 dark:bg-vibe-purple/20",
	},
];

const plannedFeatures = [
	{
		title: t("feature.analytics.title"),
		content: t("feature.analytics.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>`,
		color: "text-vibe-orange",
		bgColor: "bg-vibe-orange/10 dark:bg-vibe-orange/20",
	},
	{
		title: t("feature.security.title"),
		content: t("feature.security.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>`,
		color: "text-vibe-red",
		bgColor: "bg-vibe-red/10 dark:bg-vibe-red/20",
	},
	{
		title: t("feature.global.title"),
		content: t("feature.global.content"),
		icon: `<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
		color: "text-vibe-yellow",
		bgColor: "bg-vibe-yellow/10 dark:bg-vibe-yellow/20",
	},
];
---

<section id="features" class:list={["section relative bg-gray-50 py-24 /40 lg:py-32", className]}>
	<div class="relative z-10 col-span-12">
		<!-- Section header -->
		<div class="mx-auto mb-16 max-w-3xl text-center lg:mb-20">
			<h2 class="font-display text-4xl font-bold uppercase text-gray-900  md:text-5xl lg:text-6xl">
				{t("features.title")}
			</h2>
		</div>

		<!-- Available Now Section -->
		<div class="mx-auto mb-16 max-w-6xl">
			<h3 class="mb-6 text-center text-2xl font-bold text-gray-900 md:text-3xl">
				{t("features.available")}
			</h3>
			<div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
				{availableFeatures.map((feature, i) => (
					<div
						class="feature-card neo-card group bg-white p-6 "
						style={`animation-delay: ${i * 0.1}s;`}
					>
						<!-- Icon -->
						<div class={`mb-4 inline-flex p-3 neo-icon-box ${feature.bgColor} ${feature.color}`}>
							<Fragment set:html={feature.icon} />
						</div>

						<!-- Title -->
						<h4 class="mb-2 text-lg font-bold text-gray-900 ">
							{feature.title}
						</h4>

						<!-- Content -->
						<p class="text-sm text-gray-600 ">
							{feature.content}
						</p>
					</div>
				))}
			</div>
		</div>

		<!-- Rolling Out Section -->
		<div class="mx-auto mb-16 max-w-6xl">
			<h3 class="mb-6 text-center text-2xl font-bold text-gray-900 md:text-3xl">
				{t("features.rolling")}
			</h3>
			<div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
				{rollingFeatures.map((feature, i) => (
					<div
						class="feature-card neo-card group bg-white p-6 "
						style={`animation-delay: ${(i + availableFeatures.length) * 0.1}s;`}
					>
						<!-- Icon -->
						<div class={`mb-4 inline-flex p-3 neo-icon-box ${feature.bgColor} ${feature.color}`}>
							<Fragment set:html={feature.icon} />
						</div>

						<!-- Title -->
						<h4 class="mb-2 text-lg font-bold text-gray-900 ">
							{feature.title}
						</h4>

						<!-- Content -->
						<p class="text-sm text-gray-600 ">
							{feature.content}
						</p>
					</div>
				))}
			</div>
		</div>

		<!-- Planned Section -->
		<div class="mx-auto max-w-6xl">
			<h3 class="mb-6 text-center text-2xl font-bold text-gray-900 md:text-3xl">
				{t("features.planned")}
			</h3>
			<div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
				{plannedFeatures.map((feature, i) => (
					<div
						class="feature-card neo-card group bg-white p-6 "
						style={`animation-delay: ${(i + availableFeatures.length + rollingFeatures.length) * 0.1}s;`}
					>
						<!-- Icon -->
						<div class={`mb-4 inline-flex p-3 neo-icon-box ${feature.bgColor} ${feature.color}`}>
							<Fragment set:html={feature.icon} />
						</div>

						<!-- Title -->
						<h4 class="mb-2 text-lg font-bold text-gray-900 ">
							{feature.title}
						</h4>

						<!-- Content -->
						<p class="text-sm text-gray-600 ">
							{feature.content}
						</p>
					</div>
				))}
			</div>
		</div>
	</div>
</section>

<style>
	.feature-card {
		animation: fadeInUp 0.6s ease-out both;
	}

	@keyframes fadeInUp {
		from {
			opacity: 0;
			transform: translateY(20px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}
</style>

<script>
	function init() {
		const cards = document.querySelectorAll('.feature-card');

		const observer = new IntersectionObserver(
			(entries) => {
				entries.forEach((entry) => {
					if (entry.isIntersecting) {
						(entry.target as HTMLElement).style.animationPlayState = 'running';
					}
				});
			},
			{ threshold: 0.2 }
		);

		cards.forEach((card) => {
			(card as HTMLElement).style.animationPlayState = 'paused';
			observer.observe(card);
		});
	}

	document.removeEventListener('DOMContentLoaded', init);
	document.addEventListener('DOMContentLoaded', init);
</script>
