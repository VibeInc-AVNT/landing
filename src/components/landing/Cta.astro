---
import { getLangFromUrl, useTranslations, useTranslatedPath } from "@i18n/utils";

const { class: className } = Astro.props;

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);
---

<section id="cta" class:list={["section relative overflow-hidden bg-vibe-purple py-24 dark:bg-vibe-purple-800 lg:py-32", className]}>
	<div class="relative z-10 col-span-12">
		<div class="mx-auto max-w-4xl text-center">
			<!-- Main headline -->
			<h2 class="cta-title font-display text-4xl font-bold uppercase text-white md:text-5xl lg:text-6xl">
				{t("cta.title")}
			</h2>

			<!-- Subtitle -->
			<p class="cta-subtitle mx-auto mt-6 max-w-2xl text-lg text-vibe-purple-100 md:text-xl">
				{t("cta.subtitle")}
			</p>

			<!-- Single CTA button -->
			<div class="mt-10 flex items-center justify-center">
				<a
					href="mailto:support@avunite.com"
					class="cta-btn neo-btn group inline-flex items-center gap-2 bg-vibe-yellow px-8 py-4 text-lg font-bold text-vibe-purple-900 transition-all hover:bg-vibe-yellow-400"
				>
					{t("contact")}
					<svg class="h-5 w-5 transition-transform group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
					</svg>
				</a>
			</div>
		</div>
	</div>
</section>

<style>
	.neo-btn {
		border: 4px solid #000;
		box-shadow: 8px 8px 0 0 #000;
	}

	.neo-btn:hover {
		transform: translate(2px, 2px);
		box-shadow: 6px 6px 0 0 #000;
	}

	.cta-title {
		animation: fadeInUp 0.8s ease-out;
	}

	.cta-subtitle {
		animation: fadeInUp 0.8s ease-out 0.1s both;
	}

	.cta-btn {
		animation: fadeInUp 0.8s ease-out 0.2s both;
	}

	@keyframes fadeInUp {
		from {
			opacity: 0;
			transform: translateY(30px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}
</style>

<script>
	function init() {
		const section = document.getElementById('cta');
		if (!section) return;

		const elements = section.querySelectorAll('.cta-title, .cta-subtitle, .cta-btn');

		const observer = new IntersectionObserver(
			(entries) => {
				entries.forEach((entry) => {
					if (entry.isIntersecting) {
						elements.forEach((el) => {
							(el as HTMLElement).style.animationPlayState = 'running';
						});
					}
				});
			},
			{ threshold: 0.3 }
		);

		elements.forEach((el) => {
			(el as HTMLElement).style.animationPlayState = 'paused';
		});

		observer.observe(section);
	}

	document.removeEventListener('DOMContentLoaded', init);
	document.addEventListener('DOMContentLoaded', init);
</script>
